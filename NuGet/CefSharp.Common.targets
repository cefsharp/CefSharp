<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="PlatformCheck" BeforeTargets="ResolveAssemblyReferences" Condition="(('$(Platform)' != 'x86') AND ('$(Platform)' != 'x64') AND ('$(Platform)' != 'Win32') AND '$(CefSharpAnyCpuSupport)' != 'true')">
    <Error Text="$(MSBuildThisFileName) contains unmanaged resources, set your project and solution platform to x86 or x64. Alternatively for AnyCPU support see https://github.com/cefsharp/CefSharp/issues/1714" />
  </Target>
  
  <ItemGroup>
    <CefSharpCommonBinaries32 Include="$(MSBuildThisFileDirectory)..\CefSharp\x86\*.*" />
	<CefSharpCommonBinaries32Net40 Include="$(MSBuildThisFileDirectory)..\CefSharp-Net40\x86\*.*" />
    <CefSharpCommonBinaries64 Include="$(MSBuildThisFileDirectory)..\CefSharp\x64\*.*" />
	<CefSharpCommonBinaries64Net40 Include="$(MSBuildThisFileDirectory)..\CefSharp-Net40\x64\*.*" />
    <CefSharpCommonBinariesAnyCPU Include="$(MSBuildThisFileDirectory)..\CefSharp\**\*.*" />
	<CefSharpCommonBinariesAnyCPUNet40 Include="$(MSBuildThisFileDirectory)..\CefSharp-Net40\**\*.*" />
  </ItemGroup>

  <PropertyGroup>
    <CefSharpTargetDir Condition=" '$(CefSharpTargetDir)' == '' "></CefSharpTargetDir>
  </PropertyGroup>

  <!--
    These item groups should be in the .props file, unfortunately NuGet 2.8.x doesn't guarantee the
    correct ordering of .props imports, that we require as this depends on the cef.redist packages
    exporting an ItemGroup
   -->

  <ItemGroup Condition="('$(Platform)' == 'x86') OR ('$(Platform)' == 'Win32')">
    <None Include="@(CefRedist32)">
      <Link>$(CefSharpTargetDir)\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries32Net40)" Condition="'$(TargetFrameworkVersion)' == 'v4.0'">
      <Link>$(CefSharpTargetDir)\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries32)" Condition="'$(TargetFrameworkVersion)' != 'v4.0'">
      <Link>$(CefSharpTargetDir)\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <ItemGroup Condition="'$(Platform)' == 'x64'">
    <None Include="@(CefRedist64)">
      <Link>$(CefSharpTargetDir)\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries64Net40)" Condition="'$(TargetFrameworkVersion)' == 'v4.0'">
      <Link>$(CefSharpTargetDir)\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries64)" Condition="'$(TargetFrameworkVersion)' != 'v4.0'">
      <Link>$(CefSharpTargetDir)\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <ItemGroup Condition="'$(Platform)' == 'AnyCPU'">
    <None Include="@(CefRedist32)">
      <Link>$(CefSharpTargetDir)\x86\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefRedist64)">
      <Link>$(CefSharpTargetDir)\x64\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries32Net40)" Condition="'$(TargetFrameworkVersion)' == 'v4.0'">
      <Link>$(CefSharpTargetDir)\x86\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries64Net40)" Condition="'$(TargetFrameworkVersion)' == 'v4.0'">
      <Link>$(CefSharpTargetDir)\x64\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries32)" Condition="'$(TargetFrameworkVersion)' != 'v4.0'">
      <Link>$(CefSharpTargetDir)\x86\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="@(CefSharpCommonBinaries64)" Condition="'$(TargetFrameworkVersion)' != 'v4.0'">
      <Link>$(CefSharpTargetDir)\x64\%(RecursiveDir)%(FileName)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
</Project>
